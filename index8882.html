<!DOCTYPE html>
<html>
<head>
    <title>æ¶¨åœè‚¡æŸ¥è¯¢å·¥å…·ï¼ˆAshare2024 APIï¼‰</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .config-box { background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        input, select, button { margin: 5px; padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; }
        button { background: #007bff; color: white; cursor: pointer; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #007bff; color: white; }
        .loading { display: none; color: #666; margin: 15px 0; }
        .error { color: #dc3545; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="config-box">
        <h2>ğŸ“ˆ æ¶¨åœè‚¡æŸ¥è¯¢é…ç½®</h2>
        <input type="date" id="dateInput" value="2024-01-01">
        <select id="sessionSelect">
            <option value="all">å…¨å¤©</option>
            <option value="am">æ—©ç›˜ (09:30-11:30)</option>
            <option value="pm">åˆç›˜ (13:00-15:00)</option>
        </select>
        <input type="number" id="bigOrderInput" placeholder="å¤§å•æœ€å°é‡‘é¢(ä¸‡)" value="500" min="0">
        <button onclick="loadData()">å¼€å§‹æŸ¥è¯¢</button>
        <div id="loading" class="loading">â³ æ•°æ®åŠ è½½ä¸­...</div>
        <div id="error" class="error"></div>
    </div>

    <table id="resultTable">
        <thead>
            <tr>
                <th>è‚¡ç¥¨ä»£ç </th>
                <th>è‚¡ç¥¨åç§°</th>
                <th>æ¶¨åœæ—¶é—´</th>
                <th>æœ€æ–°ä»·</th>
                <th>æ¶¨è·Œå¹…</th>
                <th>å¤§å•å‡€æµå…¥(ä¸‡)</th>
            </tr>
        </thead>
        <tbody id="dataBody"></tbody>
    </table>

    <script>
        // å‡è®¾æ¥å£åœ°å€ï¼ˆéœ€æ ¹æ®å®é™…éƒ¨ç½²ä¿®æ”¹ï¼‰
        const API_BASE = "https://api.example.com/ashare";
        
        // æ ¸å¿ƒæ•°æ®åŠ è½½å‡½æ•°
        async function loadData() {
            const date = document.getElementById('dateInput').value.replace(/-/g, '');
            const session = document.getElementById('sessionSelect').value;
            const minBigOrder = document.getElementById('bigOrderInput').value;

            document.getElementById('loading').style.display = 'block';
            document.getElementById('error').textContent = '';

            try {
                // è°ƒç”¨æ¶¨åœè‚¡æ¥å£
                const response = await fetch(`${API_BASE}/zt?date=${date}`);
                if (!response.ok) throw new Error(`æ¥å£é”™è¯¯: ${response.status}`);
                const data = await response.json();

                // ç­›é€‰æ•°æ®ï¼ˆå‡è®¾æ¥å£è¿”å›å­—æ®µå¦‚ä¸‹ï¼‰
                const filteredData = data.filter(item => {
                    const isZt = item.limit_status === 'æ¶¨åœ';  // æ¶¨åœçŠ¶æ€
                    const timeValid = checkTime(item.limit_time, session);
                    const bigOrderValid = (item.big_order_net / 10000) >= minBigOrder;
                    return isZt && timeValid && bigOrderValid;
                });

                renderTable(filteredData);
            } catch (error) {
                document.getElementById('error').textContent = `é”™è¯¯: ${error.message}`;
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        // æ—¶é—´æ®µæ£€æŸ¥
        function checkTime(timeStr, session) {
            if (session === 'all') return true;
            const [hour] = timeStr.split(':').map(Number);
            if (session === 'am') return hour >= 9 && hour < 12;
            if (session === 'pm') return hour >= 13 && hour < 15;
            return false;
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable(data) {
            const tbody = document.getElementById('dataBody');
            tbody.innerHTML = data.map(item => `
                <tr>
                    <td>${item.symbol}</td>
                    <td>${item.name}</td>
                    <td>${item.limit_time}</td>
                    <td>${item.price.toFixed(2)}</td>
                    <td>${item.change_percent}%</td>
                    <td>${(item.big_order_net / 10000).toFixed(2)}</td>
                </tr>
            `).join('');
        }
    </script>
</body>
</html>